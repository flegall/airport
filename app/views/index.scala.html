@main("XKE Akka slot") {

<div>
    <h2>Incoming</h2>
    <ul id="incoming"></ul>
</div>
<div>
    <h2>Runway</h2>
    <ul id="runway"></ul>
</div>
<div>
    <h2>Taxiway</h2>
    <ul id="taxiway"></ul>
</div>
<div>
    <h2>Gate</h2>
    <ul id="gate"></ul>
</div>
<div>
    <h2>Done</h2>
    <ul id="done"></ul>
</div>

<script language="javascript" type="text/javascript">
    var wsUri = "ws://localhost:9000/events";
    var $incoming;
    var $runway;
    var $taxiway;
    var $gate;
    var $done;

    function init() {
        $incoming = $('#incoming');
        $runway = $('#runway');
        $taxiway = $('#taxiway');
        $gate = $('#gate');
        $done = $('#done');
        websocket = new WebSocket(wsUri);
        websocket.onmessage = function(evt) { onMessage(evt) };
    }
    function onMessage(evt) {
        console.log(evt);
        if(evt.data.substring(0,4) === 'add:'){
            addFlight(evt.data.substring(4));
        }
        if(evt.data.substring(0,6) === 'crash:'){
            crash(evt.data.substring(6));
        }
        if(evt.data.substring(0,7) === 'landed:'){
            land(evt.data.substring(7));
        }
        if(evt.data.substring(0,5) === 'taxi:'){
            taxi(evt.data.substring(5));
        }
        if(evt.data.substring(0,5) === 'park:'){
            park(evt.data.substring(5));
        }
        if(evt.data.substring(0,6) === 'leave:'){
            leave(evt.data.substring(6));
        }
    }

    function doSend(message) {
        websocket.send(message);
    }

    function addFlight(flightName){
        var $newItem = $('<li>',{
            html: flightName,
            id: flightName
        });
        $incoming.append($newItem);
    }

    function crash(flightName){
         var newItem = $('<p>',{
            html : 'OUT OF KEROZEN'
        });

        $incoming
            .find('#'+flightName)
            .css('backgroundColor','red')
            .append(newItem);
    }

    function land(flightName){
        var strip = $('#'+flightName).detach();

        $runway.append(strip);
    }

    function taxi(flightName){
        var strip = $('#'+flightName).detach();

        $taxiway.append(strip);
    }

    function park(flightName){
        var strip = $('#'+flightName).detach();

        $gate.append(strip);
    }

    function leave(flightName){
        var strip = $('#'+flightName).detach();

        $done.append(strip);
    }

    window.addEventListener("load", init, false);
</script>
}